<!--{
    "Title": "教程: 创建一个模块",
    "Path":  "/doc/tutorial/create-module"
}-->

<p>
    这是本教程的第一部分,介绍了Go语言的一些基础功能.如果你只是刚开始使用Go,请务必阅读
    <a href="getting-started.html">入门教程</a> ,里边介绍了
    <code>Go</code> 命令,Go模块与非常简单的Go代码
</p>

<p>
    本教程你将创建两个模块,第一个是被导入到其他库或程序中的库.第二个是调用第一个库的程序.
</p>

<p>
    本教程的顺序包含6个简单的主题,每个都展现出Go语言的不同的部分内容
</p>

<ol>
    <li>
        创建一个模块 -- 编写一个小模块,包含可以从另一个模块调用的函数.
    </li>
    <li>
        <a href="call-module-code.html">从另一个模块中调用你的代码</a> --
        导入并使用你的新建的模块.
    </li>
    <li>
        <a href="handle-errors.html">返回并处理错误</a> -- 添加简单的错误处理.
    </li>
    <li>
        <a href="random-greeting.html">返回一个随机的问候语</a> -- 处理切片中的数据(Go语言的动态大小的数组).
    </li>
    <li>
        <a href="greetings-multiple-people.html"
        >为多人返回问候语</a> -- 在 map 中存储键值对.
    </li>
    <li>
        <a href="add-a-test.html">增加测试</a> -- 使用GO语言内置的单元测试来测试你的代码
    </li>
    <li>
        <a href="compile-install.html">编译和安装应用</a> --
        在本地编译并安装.
    </li>
</ol>

<aside class="Note">
    <strong>注意:</strong> 其他的教程, 可以查看
    <a href="index.html">教程</a>.
</aside>

<h2 id="prerequisites">前提</h2>

<ul>
    <li>
        <strong>一些编程经验.</strong> 这里的代码很简单，但有助于了解一些功能.
    </li>
    <li>
        <strong>一个编辑代码的工具.</strong> 任何文本编辑器都可以. 大多数文本编辑器对 Go 都有很好的支持. 最受欢迎的是VSCode(免费), GoLand (付费), and Vim (免费).
    </li>
    <li>
        <strong>命令行终端.</strong>Go可以在任何终端上正常运行,如 Linux 和 Mac , 以及在 Windows中 的 PowerShell 或者 cmd.
    </li>
</ul>

<h2 id="start">创建一个能被其他库使用的模块</h2>

<p>
    首先创建一个
    <a href="https://golang.org/doc/code.html#Organization">Go 模块</a>. 在这个模块中, 你可以把散乱但有用的方法收集成为一个或多个包
    比如:你可能会创建一个模块,其中包含具有财务分析功能的包,以便于其他编写财务应用的人可以使用它.
</p>

<p>
    Go 代码被组组合到包中,包又被组合到模块中.你的包的模块会指定go运行代码需要的上下文, 包括编写代码的go版本以及所需的其他模块.
</p>

<p>
    在模块中添加或改进功能时,你将发布该模块的新版本.开发者可以导入该模块的更新包,然后写代码调用你模块中的功能,并在新版本投入生产环境前对其进行测试.
</p>

<ol>
    <li>
        代开一个终端 <code>cd</code> 回到你的主目录.

        <p>
            在 Linux 或者 Mac:
        </p>

        <pre>
cd
</pre
>

        <p>
            在 Windows:
        </p>

        <pre>
cd %HOMEPATH%
</pre
>
    </li>

    <li>
        为你的模块代码创建一个<code>greetings</code> 目录.
        你将在这里写你的模块代码.

        <p>
            例如:在你的主目录中使用以下命令:
        </p>

        <pre>
mkdir greetings
cd greetings
</pre
>
    </li>

    <li>
        在你的模块中使用
        <a href="https://golang.org/cmd/go/#hdr-Initialize_new_module_in_current_directory"
        ><code>go mod init</code> 命令</a
        >来创建一个 go.mod 文件.

        <p>
            运行 <code>go mod init</code> 命令, 并给他提供一个的模块路径. 这里使用 <code>example.com/greetings</code> 作为模块路径 -- 在生产代码中,
            这是可以下载模块的url.
        </p>

        <pre>
$ go mod init example.com/greetings
go: creating new go.mod: module example.com/greetings
</pre
>

        <p>
            <code>go mod init</code>命令创建一个 go.mod 文件 ,用来识别你的代码是否使用了其他模块. 这个刚被创建的文件只是包含了你的包名和go语言支持版本.
            但随着你添加依赖项 -- 其他模块的包 -- go.mod 文件将会列出要使用的指定模块版本.
            这样可以使构建具有可复制性，并可以直接控制要使用的模块版本.
        </p>
    </li>

    <li>
        在你的编辑器中, 创建一个 greetings.go 文件,来编写你的代码.
    </li>

    <li>
        粘贴以下代码到 greetings.go 文件中并保存它.
        <pre>
package greetings

import "fmt"

// Hello returns a greeting for the named person.
func Hello(name string) string {
    // Return a greeting that embeds the name in a message.
    message := fmt.Sprintf("Hi, %v. Welcome!", name)
    return message
}
</pre
>

        <p>
            这是你模块的第一段代码,任何代码调用它,它都会返回一句问候语,你将在下一步编写调用它的代码.
        </p>

        <p>
            在本例中, 你:
        </p>

        <ul>
            <li>
                创建一个<code>greetings</code>包,来编写相关函数
            </li>
            <li>
                实现 <code>Hello</code> 函数来返回一句问候语
                <p>
                    这个方法带有一个<code>string</code>类型的 <code>name</code> 参数,返回 <code>string</code>,
                    在Go语言中,名称已大写字母开头的函数可以被不在同一个包中的代码调用.在Go中这个叫做<a
                        href="https://tour.golang.org/basics/3"><em>导出</em></a>名.
                </p>
                <img src="images/function-syntax.png" width="300px"/>
            </li>

            <li>
                声明一个 <code>message</code> 变量 来保存问候语.
                <p>
                    在Go语言中, the <code>:=</code> 是一个在行内声明和初始化变量的简短操作符 (Go 会使用右边的值来推导变量的类型 ).
                    比较长的方式, 你可能这样写:
                </p>
                <pre>
var message string
message = fmt.Sprintf("Hi, %v. Welcome!", name)
</pre
>
            </li>

            <li>
                使用<code>fmt</code> 包中的 <code>Sprintf</code> 函数来创建一个问候语.
                第一个参数是格式字符串,Sprintf将name参数的值替换为%v,插入name参数的值将完成问候语文本
                The first argument is a format string, and
                <code>Sprintf</code> substitutes the <code>name</code> parameter's value
                for the <code>%v</code> format verb. Inserting the value of the
                <code>name</code> parameter completes the greeting text.
            </li>
            <li>返回被格式化的问候文本语给调用者.</li>
        </ul>
    </li>
</ol>

<p>
    <a href="call-module-code.html">下一步</a>,你将从其他模块中调用这个函数.
</p>

<p class="Navigation">
    <a class="Navigation-next" href="call-module-code.html"
    >从其他模块中调用你的代码 &gt;</a
    >
</p>
